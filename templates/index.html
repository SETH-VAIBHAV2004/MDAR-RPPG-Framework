<!DOCTYPE html>
<html>
<head>
    <title>Remote Photoplethysmography</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            margin: 20px 0;
        }
        .camera-selection {
            margin: 20px 0;
        }
        select, button {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: all 0.3s ease;
        }
        select option {
            background: #333;
            color: white;
        }
        button:hover, select:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .status {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 18px;
            font-weight: bold;
        }
        .status.running { background: rgba(76, 175, 80, 0.3); }
        .status.stopped { background: rgba(244, 67, 54, 0.3); }
        .status.info { background: rgba(33, 150, 243, 0.3); }
        h1 { 
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #ffffff, #e0e7ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            color: rgba(255, 255, 255, 0.9);
        }
        .video-container {
            display: flex;
            gap: 20px;
            align-items: flex-start;
            justify-content: center;
            flex-wrap: wrap;
        }
        .video-box {
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            min-width: 400px;
        }
        #video {
            width: 100%;
            max-width: 640px;
            border-radius: 10px;
        }
        #canvas {
            display: none;
        }
        .metrics {
            min-width: 300px;
        }
        .hr-display {
            font-size: 3rem;
            font-weight: bold;
            color: #4CAF50;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        .confidence-display {
            font-size: 1.2rem;
            margin: 10px 0;
        }
        .method-comparison {
            margin: 20px 0;
            text-align: left;
        }
        .method-row {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 5px 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }
        .method-name {
            font-weight: bold;
        }
        .method-value {
            color: #4CAF50;
        }
        .upload-form {
            text-align: left;
            max-width: 600px;
            margin: 0 auto;
        }
        .form-group {
            margin: 20px 0;
        }
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
        }
        .form-control:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
        }
        .results {
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .feature-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        .feature-card:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-5px);
        }
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        .feature-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .feature-description {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }

        /* Enhanced Tabbed Interface Styles */
        .main-nav {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .nav-tab {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 1.5rem;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 1rem;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .nav-tab:hover::before {
            left: 100%;
        }

        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--primary-color, #667eea), var(--accent-color, #764ba2));
            border-color: rgba(255, 255, 255, 0.5);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .nav-icon {
            font-size: 1.2rem;
        }

        .nav-label {
            font-weight: 600;
        }

        /* Tab Content */
        .tab-container {
            margin-top: 2rem;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Section Headers */
        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-header h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: white;
        }

        .section-icon {
            margin-right: 0.5rem;
            font-size: 1.8rem;
        }

        .section-description {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.8);
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Upload Section Styles */
        .upload-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .upload-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 1.5rem;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(15px);
        }

        .upload-area {
            position: relative;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 1rem;
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
        }

        .upload-area:hover {
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.05);
        }

        .upload-area.drag-over {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.7;
        }

        .upload-text h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: white;
        }

        .upload-text p {
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 0.5rem;
        }

        .upload-text small {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
        }

        .file-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .upload-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        /* Button Styles */
        .btn-primary, .btn-secondary, .btn-danger {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.3);
        }

        .btn-primary:disabled {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .btn-danger {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }

        .btn-danger:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(244, 67, 54, 0.3);
        }

        .btn-danger:disabled {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
        }

        /* Upload Info Section */
        .upload-info h3 {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            color: white;
        }

        .info-icon {
            margin-right: 0.5rem;
            font-size: 1.3rem;
        }

        .method-grid {
            display: grid;
            gap: 1rem;
        }

        .method-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .method-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 0.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            font-size: 0.9rem;
            min-width: 50px;
            text-align: center;
        }

        .method-details h4 {
            margin-bottom: 0.25rem;
            color: white;
            font-size: 1rem;
        }

        .method-details p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            margin: 0;
        }

        /* Webcam Section Styles */
        .webcam-section {
            margin-bottom: 2rem;
        }

        .camera-setup {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .setup-card, .instructions-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 1.5rem;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(15px);
        }

        .setup-header h3, .instructions-card h3 {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            color: white;
            font-size: 1.3rem;
        }

        .setup-icon, .instructions-icon {
            margin-right: 0.5rem;
            font-size: 1.5rem;
        }

        .input-label {
            display: block;
            margin-bottom: 0.5rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }

        .select-wrapper {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .camera-select {
            flex: 1;
            padding: 0.75rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 0.5rem;
            color: white;
            font-size: 1rem;
        }

        .refresh-btn {
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 0.5rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .camera-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .status-card {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 1.5rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.75rem;
            color: white;
        }

        .status-icon {
            font-size: 1.2rem;
        }

        /* Instructions */
        .instruction-steps {
            display: grid;
            gap: 1rem;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .step-number {
            width: 2rem;
            height: 2rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .step-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
        }

        /* About Section Styles */
        .about-section {
            max-width: 1000px;
            margin: 0 auto;
        }

        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .tech-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 1.5rem;
            padding: 2rem;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(15px);
            transition: all 0.3s ease;
        }

        .tech-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .tech-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
        }

        .tech-card h3 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: white;
        }

        .tech-card p {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            margin: 0;
        }

        .science-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 1.5rem;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(15px);
            text-align: left;
        }

        .science-section h3 {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            color: white;
            font-size: 1.5rem;
        }

        .science-icon {
            margin-right: 0.5rem;
            font-size: 1.7rem;
        }

        .science-section p {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.7;
            margin-bottom: 1.5rem;
            font-size: 1.05rem;
        }

        .science-list {
            list-style: none;
            padding: 0;
        }

        .science-list li {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 0.75rem;
            padding-left: 2rem;
            position: relative;
            line-height: 1.5;
        }

        .science-list li::before {
            content: '🔹';
            position: absolute;
            left: 0;
            top: 0;
        }

        /* Results Section */
        .results-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 1.5rem;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(15px);
            margin-top: 2rem;
        }

        /* Enhanced Camera Section Styles */
        .camera-features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .feature-highlight {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 1.2rem;
            padding: 2rem;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .feature-highlight:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .feature-highlight-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }

        .feature-highlight h3 {
            font-size: 1.2rem;
            margin-bottom: 0.75rem;
            color: white;
        }

        .feature-highlight p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
            line-height: 1.5;
            margin: 0;
        }

        .camera-main-section {
            margin-bottom: 3rem;
        }

        .camera-control-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2rem;
            padding: 3rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .control-header {
            margin-bottom: 2.5rem;
        }

        .control-header h3 {
            font-size: 1.8rem;
            margin-bottom: 0.75rem;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .control-icon {
            font-size: 2rem;
        }

        .control-description {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.8);
            margin: 0;
        }

        .main-camera-controls {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .btn-primary-large, .btn-danger-large {
            display: flex;
            align-items: center;
            padding: 1.5rem 2rem;
            border: none;
            border-radius: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            min-width: 280px;
            backdrop-filter: blur(10px);
        }

        .btn-primary-large {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .btn-primary-large:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(76, 175, 80, 0.4);
            background: linear-gradient(135deg, #5CBF60, #4fb052);
        }

        .btn-primary-large:disabled {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
            transform: none;
        }

        .btn-danger-large {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }

        .btn-danger-large:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(244, 67, 54, 0.4);
            background: linear-gradient(135deg, #f55a4e, #dc4440);
        }

        .btn-danger-large:disabled {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
            transform: none;
        }

        .btn-content {
            display: flex;
            align-items: center;
            gap: 1rem;
            width: 100%;
        }

        .btn-icon-large {
            font-size: 1.8rem;
            flex-shrink: 0;
        }

        .btn-text-group {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            flex-grow: 1;
        }

        .btn-text-main {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.2rem;
        }

        .btn-text-sub {
            font-size: 0.9rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .status-card-enhanced {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.5rem 2rem;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1rem;
            color: white;
            justify-content: center;
        }

        .status-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .status-text {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .status-subtext {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .camera-info-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .instructions-card, .tips-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 1.5rem;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(15px);
        }

        .instructions-card h3, .tips-card h3 {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            color: white;
            font-size: 1.3rem;
        }

        .instructions-icon, .tips-icon {
            margin-right: 0.5rem;
            font-size: 1.5rem;
        }

        .step-content {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .step-text {
            color: rgba(255, 255, 255, 0.95);
            font-size: 1rem;
            font-weight: 500;
        }

        .step-detail {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
            line-height: 1.3;
        }

        .tips-list {
            display: grid;
            gap: 1.25rem;
        }

        .tip-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .tip-icon {
            font-size: 1.3rem;
            flex-shrink: 0;
            margin-top: 0.1rem;
        }

        .tip-content {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.5;
            font-size: 0.95rem;
        }

        .tip-content strong {
            color: white;
            font-weight: 600;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .upload-section,
            .camera-setup,
            .camera-info-section {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .tech-grid,
            .camera-features-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .main-nav {
                flex-direction: column;
                align-items: center;
            }

            .nav-tab {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }

            .camera-controls,
            .main-camera-controls {
                flex-direction: column;
                align-items: center;
            }

            .upload-actions {
                flex-direction: column;
            }

            .section-header h2 {
                font-size: 1.5rem;
            }

            .btn-primary-large, .btn-danger-large {
                min-width: 100%;
                max-width: 400px;
            }

            .camera-control-card {
                padding: 2rem;
            }

            .control-header h3 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🫀 Remote Photoplethysmography</h1>
            <p class="subtitle">Advanced Heart Rate Monitoring using rPPG Technology</p>
        </div>
        
        <!-- Main Navigation Tabs -->
        <div class="main-nav">
            <button class="nav-tab active" onclick="switchTab('upload')">
                <span class="nav-icon">📤</span>
                <span class="nav-label">Video Upload</span>
            </button>
            <button class="nav-tab" onclick="switchTab('webcam')">
                <span class="nav-icon">📹</span>
                <span class="nav-label">Live Camera</span>
            </button>
            <button class="nav-tab" onclick="switchTab('about')">
                <span class="nav-icon">ℹ️</span>
                <span class="nav-label">About</span>
            </button>
        </div>

        <!-- Tab Content Container -->
        <div class="tab-container">
            
            <!-- Video Upload Tab -->
            <div id="upload-tab" class="tab-content active">
                <div class="section-header">
                    <h2><span class="section-icon">📁</span> Video Upload Analysis</h2>
                    <p class="section-description">Upload a video file for advanced heart rate analysis using AI-powered rPPG technology</p>
                </div>
                
                <div class="upload-section">
                    <div class="upload-card">
                        <div class="upload-area" id="uploadArea">
                            <div class="upload-icon">📎</div>
                            <div class="upload-text">
                                <h3>Drop your video here</h3>
                                <p>or click to browse files</p>
                                <small>Supports: MP4, AVI, MOV, MKV, WebM, M4V (up to 5GB)</small>
                            </div>
                            <input type="file" id="videoFile" name="file" accept="video/*,.mp4,.avi,.mov,.mkv,.webm,.m4v" class="file-input" required>
                        </div>
                        
                        <div class="upload-actions">
                            <button type="button" id="uploadBtn" class="btn-primary" disabled>
                                <span class="btn-icon">📤</span>
                                <span class="btn-text">Upload & Analyze</span>
                            </button>
                            <button type="button" id="clearBtn" class="btn-secondary" onclick="clearUpload()">
                                <span class="btn-icon">🗑️</span>
                                <span class="btn-text">Clear</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="upload-info">
                        <h3><span class="info-icon">🔬</span> Analysis Methods</h3>
                        <div class="method-grid">
                            <div class="method-item">
                                <div class="method-badge">AI</div>
                                <div class="method-details">
                                    <h4>MDAR Neural Network</h4>
                                    <p>Deep learning model trained on physiological signals</p>
                                </div>
                            </div>
                            <div class="method-item">
                                <div class="method-badge">POS</div>
                                <div class="method-details">
                                    <h4>Plane Orthogonal to Skin</h4>
                                    <p>Traditional computer vision method for pulse detection</p>
                                </div>
                            </div>
                            <div class="method-item">
                                <div class="method-badge">CHROM</div>
                                <div class="method-details">
                                    <h4>Chrominance Method</h4>
                                    <p>Color-based physiological signal extraction</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="videoUploadStatus" class="status-card" style="display: none;"></div>
                <div id="videoResults" class="results-section" style="display: none;"></div>
            </div>
            
            <!-- Live Camera Tab -->
            <div id="webcam-tab" class="tab-content">
                <div class="section-header">
                    <h2><span class="section-icon">📹</span> Live Camera Monitoring</h2>
                    <p class="section-description">Real-time heart rate monitoring using your camera with advanced signal processing</p>
                </div>
                
                <!-- Camera Features Overview -->
                <div class="camera-features-grid">
                    <div class="feature-highlight">
                        <div class="feature-highlight-icon">⚡</div>
                        <h3>Real-Time Processing</h3>
                        <p>Get instant heart rate readings with our advanced rPPG algorithms</p>
                    </div>
                    <div class="feature-highlight">
                        <div class="feature-highlight-icon">🎯</div>
                        <h3>High Accuracy</h3>
                        <p>Multi-method fusion ensures reliable and precise measurements</p>
                    </div>
                    <div class="feature-highlight">
                        <div class="feature-highlight-icon">🔒</div>
                        <h3>Privacy First</h3>
                        <p>All processing happens locally - no data leaves your device</p>
                    </div>
                </div>
                
                <div class="webcam-section">
                    <!-- Main Camera Control Section -->
                    <div class="camera-main-section">
                        <div class="camera-control-card">
                            <div class="control-header">
                                <h3><span class="control-icon">📹</span> Camera Control Center</h3>
                                <p class="control-description">Start your real-time heart rate monitoring session</p>
                            </div>
                            
                            <div class="camera-selection">
                                <label for="cameraSelect" class="input-label">Select Camera Device:</label>
                                <div class="select-wrapper">
                                    <select id="cameraSelect" class="camera-select">
                                        <option value="">🔄 Loading cameras...</option>
                                    </select>
                                    <button type="button" onclick="refreshCameras()" class="refresh-btn">
                                        <span class="btn-icon">🔄</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="main-camera-controls">
                                <button id="startCamera" onclick="startCamera()" class="btn-primary-large">
                                    <div class="btn-content">
                                        <span class="btn-icon-large">🚀</span>
                                        <div class="btn-text-group">
                                            <span class="btn-text-main">Start Live Monitoring</span>
                                            <span class="btn-text-sub">Begin real-time heart rate analysis</span>
                                        </div>
                                    </div>
                                </button>
                                <button id="stopCamera" onclick="stopCamera()" class="btn-danger-large" disabled>
                                    <div class="btn-content">
                                        <span class="btn-icon-large">🛑</span>
                                        <div class="btn-text-group">
                                            <span class="btn-text-main">Stop Monitoring</span>
                                            <span class="btn-text-sub">End current monitoring session</span>
                                        </div>
                                    </div>
                                </button>
                            </div>
                            
                            <div class="status-card-enhanced" id="status">
                                <span class="status-icon">💡</span>
                                <div class="status-content">
                                    <span class="status-text">Ready to start monitoring</span>
                                    <span class="status-subtext">Select a camera and click Start to begin</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Instructions and Tips Section -->
                    <div class="camera-info-section">
                        <div class="instructions-card">
                            <h3><span class="instructions-icon">📋</span> Setup Instructions</h3>
                            <div class="instruction-steps">
                                <div class="step">
                                    <div class="step-number">1</div>
                                    <div class="step-content">
                                        <div class="step-text">Position yourself 2-3 feet from the camera</div>
                                        <div class="step-detail">Optimal distance ensures clear facial detection</div>
                                    </div>
                                </div>
                                <div class="step">
                                    <div class="step-number">2</div>
                                    <div class="step-content">
                                        <div class="step-text">Ensure good lighting on your face</div>
                                        <div class="step-detail">Avoid backlighting and shadows for best results</div>
                                    </div>
                                </div>
                                <div class="step">
                                    <div class="step-number">3</div>
                                    <div class="step-content">
                                        <div class="step-text">Stay still and face the camera</div>
                                        <div class="step-detail">Minimize movement for accurate signal detection</div>
                                    </div>
                                </div>
                                <div class="step">
                                    <div class="step-number">4</div>
                                    <div class="step-content">
                                        <div class="step-text">Wait 15-30 seconds for stabilization</div>
                                        <div class="step-detail">Initial readings may fluctuate as the system calibrates</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tips-card">
                            <h3><span class="tips-icon">💡</span> Pro Tips</h3>
                            <div class="tips-list">
                                <div class="tip-item">
                                    <span class="tip-icon">🌟</span>
                                    <div class="tip-content">
                                        <strong>Optimal Lighting:</strong> Use natural light or soft artificial lighting facing you
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <span class="tip-icon">🎯</span>
                                    <div class="tip-content">
                                        <strong>Camera Angle:</strong> Position camera at eye level for best facial detection
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <span class="tip-icon">⏱️</span>
                                    <div class="tip-content">
                                        <strong>Measurement Time:</strong> Allow 30-60 seconds for most accurate readings
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <span class="tip-icon">🔄</span>
                                    <div class="tip-content">
                                        <strong>Multiple Methods:</strong> System uses 3 different algorithms for validation
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- About Tab -->
            <div id="about-tab" class="tab-content">
                <div class="section-header">
                    <h2><span class="section-icon">🔬</span> About Remote Photoplethysmography</h2>
                    <p class="section-description">Learn about the technology and science behind contactless heart rate monitoring</p>
                </div>
                
                <div class="about-section">
                    <div class="tech-grid">
                        <div class="tech-card">
                            <div class="tech-icon">📹</div>
                            <h3>Contactless Monitoring</h3>
                            <p>Uses your camera to detect subtle color changes in your skin caused by blood circulation, eliminating the need for physical sensors.</p>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon">🧠</div>
                            <h3>AI-Powered Analysis</h3>
                            <p>Advanced MDAR neural network trained on physiological signals combined with traditional computer vision methods.</p>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon">📊</div>
                            <h3>Multi-Method Fusion</h3>
                            <p>Combines MDAR, POS, and CHROM methods with ensemble learning for improved accuracy and reliability.</p>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon">⚡</div>
                            <h3>Real-Time Processing</h3>
                            <p>Processes video frames in real-time with advanced signal processing and filtering techniques.</p>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon">🎯</div>
                            <h3>High Accuracy</h3>
                            <p>Achieves clinical-grade accuracy through advanced signal processing and machine learning algorithms.</p>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon">🔒</div>
                            <h3>Privacy Focused</h3>
                            <p>All processing happens locally on your device. No personal data or video is stored or transmitted.</p>
                        </div>
                    </div>
                    
                    <div class="science-section">
                        <h3><span class="science-icon">🔬</span> The Science</h3>
                        <p>Remote Photoplethysmography (rPPG) works by detecting minute changes in light absorption caused by blood volume variations in facial blood vessels. When your heart beats, it pumps blood through your circulatory system, causing subtle changes in the amount of light absorbed and reflected by your skin.</p>
                        
                        <p>Our system uses advanced computer vision and machine learning techniques to:</p>
                        <ul class="science-list">
                            <li>Detect and track facial regions of interest</li>
                            <li>Extract physiological signals from color variations</li>
                            <li>Filter noise and artifacts using signal processing</li>
                            <li>Apply machine learning models for accurate heart rate estimation</li>
                            <li>Validate results using multiple independent methods</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="video-container" id="videoContainer" style="display: none;">
            <div class="video-box">
                <video id="video" autoplay muted playsinline></video>
                <canvas id="canvas"></canvas>
            </div>
            
            <div class="metrics card">
                <div class="hr-display" id="hrDisplay">-- BPM</div>
                <div class="confidence-display" id="confidence">Confidence: --%</div>
                
                <div class="method-comparison">
                    <h3>📊 Method Comparison</h3>
                    <div class="method-row">
                        <span class="method-name">MDAR Model:</span>
                        <span class="method-value" id="hrMdar">--</span>
                    </div>
                    <div class="method-row">
                        <span class="method-name">POS Method:</span>
                        <span class="method-value" id="hrPos">--</span>
                    </div>
                    <div class="method-row">
                        <span class="method-name">CHROM Method:</span>
                        <span class="method-value" id="hrChrom">--</span>
                    </div>
                    <div class="method-row">
                        <span class="method-name">Buffer Size:</span>
                        <span class="method-value" id="bufferSize">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="/static/js/app.js"></script>
    <script>
        let video, canvas, ctx, ws;
        let isRunning = false;
        let frameCount = 0;
        let selectedCamera = null;
        
        // Load available cameras on page load
        window.onload = async () => {
            video = document.getElementById('video');
            canvas = document.getElementById('canvas');
            ctx = canvas.getContext('2d');
            canvas.width = 640;
            canvas.height = 480;
            
            await refreshCameras();
            initializeVideoUpload();
        };
        
        async function refreshCameras() {
            try {
                const response = await fetch('/api/cameras/list');
                const cameras = await response.json();
                
                const select = document.getElementById('cameraSelect');
                select.innerHTML = '';
                
                if (cameras.length === 0) {
                    select.innerHTML = '<option value="">No cameras found</option>';
                    return;
                }
                
                cameras.forEach((camera, index) => {
                    const option = document.createElement('option');
                    option.value = camera.id;
                    option.textContent = `Camera ${camera.id}: ${camera.description}`;
                    select.appendChild(option);
                });
                
                // Select first camera by default
                if (cameras.length > 0) {
                    select.value = cameras[0].id;
                    selectedCamera = cameras[0].id;
                }
            } catch (error) {
                console.error('Failed to load cameras:', error);
                document.getElementById('cameraSelect').innerHTML = '<option value="">Error loading cameras</option>';
            }
        }
        
        function updateDisplay(data) {
            if (data.hr_bpm) {
                document.getElementById('hrDisplay').textContent = data.hr_bpm.toFixed(1) + ' BPM';
                document.getElementById('confidence').textContent = `Confidence: ${data.confidence.toFixed(1)}%`;
                
                document.getElementById('hrMdar').textContent = data.hr_mdar ? data.hr_mdar.toFixed(1) : '--';
                document.getElementById('hrPos').textContent = data.hr_pos ? data.hr_pos.toFixed(1) : '--';
                document.getElementById('hrChrom').textContent = data.hr_chrom ? data.hr_chrom.toFixed(1) : '--';
                
                const statusEl = document.getElementById('status');
                if (data.reliable) {
                    statusEl.textContent = '✅ Reading reliable';
                    statusEl.className = 'status running';
                } else {
                    statusEl.textContent = '⚠️ Reading may be unreliable';
                    statusEl.className = 'status info';
                }
            }
            
            if (data.buffer_size !== undefined) {
                document.getElementById('bufferSize').textContent = data.buffer_size;
            }
            
            if (data.waiting_for_data) {
                document.getElementById('status').textContent = 
                    `🔄 Collecting data... (${data.buffer_size}/90 frames)`;
                document.getElementById('status').className = 'status info';
            }
            
            if (data.error) {
                document.getElementById('status').textContent = `❌ Error: ${data.error}`;
                document.getElementById('status').className = 'status stopped';
            }
        }
        
        function sendFrame() {
            if (!isRunning || !ws || ws.readyState !== WebSocket.OPEN) return;
            
            frameCount++;
            // Send every 3rd frame to reduce bandwidth
            if (frameCount % 3 !== 0) {
                requestAnimationFrame(sendFrame);
                return;
            }
            
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            const frameData = canvas.toDataURL('image/jpeg', 0.7);
            
            ws.send(JSON.stringify({
                type: 'frame',
                frame: frameData
            }));
            
            requestAnimationFrame(sendFrame);
        }
        
        async function startCamera() {
            selectedCamera = document.getElementById('cameraSelect').value;
            if (!selectedCamera) {
                alert('Please select a camera first');
                return;
            }
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { width: 640, height: 480, frameRate: 30 } 
                });
                
                video.srcObject = stream;
                document.getElementById('videoContainer').style.display = 'flex';
                
                // Initialize WebSocket
                ws = new WebSocket(`ws://${window.location.host}/ws/live`);
                
                ws.onopen = () => {
                    console.log('WebSocket connected');
                    isRunning = true;
                    sendFrame();
                    document.getElementById('startCamera').disabled = true;
                    document.getElementById('stopCamera').disabled = false;
                    document.getElementById('status').textContent = '🔄 Camera started, processing...';
                    document.getElementById('status').className = 'status info';
                };
                
                ws.onmessage = (event) => {
                    const message = JSON.parse(event.data);
                    if (message.type === 'prediction') {
                        updateDisplay(message.data);
                    }
                };
                
                ws.onerror = (error) => {
                    console.error('WebSocket error:', error);
                    document.getElementById('status').textContent = '❌ Connection error';
                    document.getElementById('status').className = 'status stopped';
                };
                
                ws.onclose = () => {
                    console.log('WebSocket disconnected');
                    isRunning = false;
                };
                
            } catch (err) {
                console.error('Camera error:', err);
                document.getElementById('status').textContent = '❌ Camera access denied';
                document.getElementById('status').className = 'status stopped';
            }
        }
        
        function stopCamera() {
            isRunning = false;
            
            if (video.srcObject) {
                video.srcObject.getTracks().forEach(track => track.stop());
                video.srcObject = null;
            }
            
            if (ws) {
                ws.close();
                ws = null;
            }
            
            document.getElementById('videoContainer').style.display = 'none';
            document.getElementById('startCamera').disabled = false;
            document.getElementById('stopCamera').disabled = true;
            document.getElementById('status').textContent = 'Camera stopped';
            document.getElementById('status').className = 'status stopped';
            document.getElementById('hrDisplay').textContent = '-- BPM';
            document.getElementById('confidence').textContent = 'Confidence: --%';
        }
        
        // Update camera selection
        document.getElementById('cameraSelect').addEventListener('change', function() {
            selectedCamera = this.value;
        });
        
        
        // Tab switching functionality
        function switchTab(tabName) {
            // Remove active class from all tabs and content
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Add active class to clicked tab and corresponding content
            event.target.closest('.nav-tab').classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }
        
        // Upload functionality
        function initializeVideoUpload() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('videoFile');
            const uploadBtn = document.getElementById('uploadBtn');
            const statusDiv = document.getElementById('videoUploadStatus');
            const resultsDiv = document.getElementById('videoResults');
            
            // File input change handler
            fileInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    const file = this.files[0];
                    updateUploadArea(file.name);
                    uploadBtn.disabled = false;
                } else {
                    resetUploadArea();
                    uploadBtn.disabled = true;
                }
            });
            
            // Drag and drop functionality
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('drag-over');
            });
            
            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.classList.remove('drag-over');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('drag-over');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    fileInput.files = files;
                    const file = files[0];
                    updateUploadArea(file.name);
                    uploadBtn.disabled = false;
                }
            });
            
            // Upload button click handler
            uploadBtn.addEventListener('click', async function() {
                const file = fileInput.files[0];
                if (!file) {
                    alert('Please select a video file');
                    return;
                }
                
                statusDiv.style.display = 'block';
                statusDiv.innerHTML = '<span class="status-icon">📤</span><span class="status-text">Uploading and analyzing video...</span>';
                statusDiv.className = 'status-card info';
                
                const formData = new FormData();
                formData.append('file', file);
                
                try {
                    const response = await fetch('/api/video/upload', {
                        method: 'POST',
                        body: formData
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok) {
                        statusDiv.innerHTML = '<span class="status-icon">✅</span><span class="status-text">Analysis complete!</span>';
                        statusDiv.className = 'status-card running';
                        
                        displayResults(result);
                    } else {
                        statusDiv.innerHTML = `<span class="status-icon">❌</span><span class="status-text">Error: ${result.error}</span>`;
                        statusDiv.className = 'status-card stopped';
                        resultsDiv.style.display = 'none';
                    }
                } catch (error) {
                    console.error('Upload error:', error);
                    statusDiv.innerHTML = `<span class="status-icon">❌</span><span class="status-text">Upload failed: ${error.message}</span>`;
                    statusDiv.className = 'status-card stopped';
                    resultsDiv.style.display = 'none';
                }
            });
        }
        
        function updateUploadArea(fileName) {
            const uploadArea = document.getElementById('uploadArea');
            const uploadText = uploadArea.querySelector('.upload-text');
            uploadText.innerHTML = `
                <h3>📁 ${fileName}</h3>
                <p>File selected and ready for analysis</p>
                <small>Click "Upload & Analyze" to proceed</small>
            `;
        }
        
        function resetUploadArea() {
            const uploadArea = document.getElementById('uploadArea');
            const uploadText = uploadArea.querySelector('.upload-text');
            uploadText.innerHTML = `
                <h3>Drop your video here</h3>
                <p>or click to browse files</p>
                <small>Supports: MP4, AVI, MOV, MKV, WebM, M4V (up to 5GB)</small>
            `;
        }
        
        function clearUpload() {
            const fileInput = document.getElementById('videoFile');
            const uploadBtn = document.getElementById('uploadBtn');
            const statusDiv = document.getElementById('videoUploadStatus');
            const resultsDiv = document.getElementById('videoResults');
            
            fileInput.value = '';
            uploadBtn.disabled = true;
            resetUploadArea();
            statusDiv.style.display = 'none';
            resultsDiv.style.display = 'none';
        }
        
        function displayResults(result) {
            const resultsDiv = document.getElementById('videoResults');
            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = `
                <h3><span class="info-icon">📊</span> Analysis Results</h3>
                <div class="method-comparison">
                    <div class="method-row">
                        <span class="method-name">Final Heart Rate:</span>
                        <span class="method-value">${result.hr_bpm.toFixed(1)} BPM</span>
                    </div>
                    <div class="method-row">
                        <span class="method-name">Confidence:</span>
                        <span class="method-value">${result.confidence.toFixed(1)}%</span>
                    </div>
                    <div class="method-row">
                        <span class="method-name">Reliable:</span>
                        <span class="method-value">${result.reliable ? 'Yes' : 'No'}</span>
                    </div>
                    ${result.hr_mdar ? `
                    <div class="method-row">
                        <span class="method-name">MDAR Model:</span>
                        <span class="method-value">${result.hr_mdar.toFixed(1)} BPM</span>
                    </div>
                    ` : ''}
                    ${result.hr_pos ? `
                    <div class="method-row">
                        <span class="method-name">POS Method:</span>
                        <span class="method-value">${result.hr_pos.toFixed(1)} BPM</span>
                    </div>
                    ` : ''}
                    ${result.hr_chrom ? `
                    <div class="method-row">
                        <span class="method-name">CHROM Method:</span>
                        <span class="method-value">${result.hr_chrom.toFixed(1)} BPM</span>
                    </div>
                    ` : ''}
                    <div class="method-row">
                        <span class="method-name">Frames Processed:</span>
                        <span class="method-value">${result.frames_processed}</span>
                    </div>
                    <div class="method-row">
                        <span class="method-name">FPS:</span>
                        <span class="method-value">${result.fps ? result.fps.toFixed(1) : 'N/A'}</span>
                    </div>
                    <div class="method-row">
                        <span class="method-name">Processing Time:</span>
                        <span class="method-value">${result.processing_time ? result.processing_time.toFixed(1) : 'N/A'}s</span>
                    </div>
                </div>
            `;
        }
        
        // Cleanup on page unload
        window.onbeforeunload = stopCamera;
    </script>
</body>
</html>
